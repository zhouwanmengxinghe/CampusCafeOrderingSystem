@model PaymentResult
@{
    ViewData["Title"] = "Payment Success";
    Layout = "~/Views/Shared/_Layout.cshtml";
    var orderNumber = ViewBag.OrderNumber as string ?? "N/A";
    var order = ViewBag.Order as Order;
}

<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card shadow-lg">
                <div class="card-body text-center p-5">
                    <!-- Success Icon -->
                    <div class="success-icon mb-4">
                        <i class="fas fa-check-circle fa-5x text-success"></i>
                    </div>
                    
                    <!-- Success Message -->
                    <h2 class="text-success mb-3">Payment Successful!</h2>
                    <p class="lead text-muted mb-4">@Model.Message</p>
                    <p class="text-muted">Order Number: <strong>@orderNumber</strong></p>
                    
                    <!-- Transaction Details -->
                    <div class="transaction-details">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="detail-item">
                                    <i class="fas fa-receipt text-primary"></i>
                                    <div class="detail-content">
                                        <strong>Transaction ID</strong>
                                        <p>@Model.TransactionId</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="detail-item">
                                    <i class="fas fa-clock text-info"></i>
                                    <div class="detail-content">
                                        <strong>Transaction Time</strong>
                                        <p>@Model.TransactionTime.ToString("yyyy-MM-dd HH:mm:ss")</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="detail-item">
                                    <i class="fas fa-credit-card text-warning"></i>
                                    <div class="detail-content">
                                        <strong>Payment Method</strong>
                                        <p>@Model.PaymentMethod</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="detail-item">
                                    <i class="fas fa-dollar-sign text-success"></i>
                                    <div class="detail-content">
                                        <strong>Amount Paid</strong>
                                        <p>$@Model.Amount.ToString("F2")</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="detail-item">
                                    <i class="fas fa-clock text-info"></i>
                                    <div class="detail-content">
                                        <strong>Transaction Time</strong>
                                        <p>@Model.TransactionTime.ToString("yyyy-MM-dd HH:mm:ss")</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-3">
                            <div class="col-md-6">
                                <div class="detail-item">
                                    <i class="fas fa-credit-card text-warning"></i>
                                    <div class="detail-content">
                                        <strong>Payment Method</strong>
                                        <p>
                                            @switch(Model.PaymentMethod)
                                            {
                                                case "CreditCard":
                                                    <span>Credit/Debit Card</span>
                                                    break;
                                                case "CampusCard":
                                                    <span>Campus Card</span>
                                                    break;
                                                case "MobileWallet":
                                                    <span>Mobile Wallet</span>
                                                    break;
                                                default:
                                                    <span>@Model.PaymentMethod</span>
                                                    break;
                                            }
                                        </p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="detail-item">
                                    <i class="fas fa-dollar-sign text-success"></i>
                                    <div class="detail-content">
                                        <strong>Payment Amount</strong>
                                        <p class="amount">$@Model.Amount.ToString("F2")</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Processing Status -->
                    <div class="processing-status mt-4">
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle"></i>
                            <strong>Order Processing</strong> - Your order is being prepared. Please wait patiently.
                            @if (TempData["OrderNumber"] != null)
                            {
                                <br><strong>Order Number:</strong> <span class="order-number">@TempData["OrderNumber"]</span>
                            }
                        </div>
                    </div>
                    
                    <!-- Action Buttons -->
                    <div class="action-buttons mt-4">
                        <div class="row">
                            @if (TempData["OrderNumber"] != null)
                            {
                                <div class="col-md-3 mb-2">
                                    <a asp-controller="Order" asp-action="Track" asp-route-orderNumber="@TempData["OrderNumber"]" class="btn btn-primary w-100">
                                        <i class="fas fa-map-marker-alt"></i> Track Order
                                    </a>
                                </div>
                            }
                            <div class="col-md-3 mb-2">
                                <a asp-controller="Menu" asp-action="Index" class="btn btn-outline-primary w-100">
                                    <i class="fas fa-utensils"></i> Continue Shopping
                                </a>
                            </div>
                            @if (User.Identity.IsAuthenticated)
                            {
                                <div class="col-md-3 mb-2">
                                    <a asp-controller="Order" asp-action="MyOrders" class="btn btn-outline-success w-100">
                                        <i class="fas fa-list"></i> My Orders
                                    </a>
                                </div>
                            }
                            <div class="col-md-3 mb-2">
                                <a href="#" class="btn btn-outline-info w-100" onclick="printReceipt()">
                                    <i class="fas fa-print"></i> Print Receipt
                                </a>
                            </div>
                        </div>
                        <div class="row mt-2">
                            <div class="col-12">
                                <a asp-controller="Home" asp-action="Index" class="btn btn-success w-100">
                                    <i class="fas fa-home"></i> Back to Home
                                </a>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Customer Service -->
                    <div class="customer-service mt-4">
                        <p class="text-muted">
                            <i class="fas fa-headset"></i>
                            For any questions, please contact customer service: <strong>400-123-4567</strong>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Hidden Receipt Content for Printing -->
<div id="receiptContent" style="display: none;">
    <div class="receipt">
        <div class="receipt-header">
            <h3>Campus Cafe</h3>
            <p>Campus Cafe Ordering System</p>
            <hr>
        </div>
        
        <div class="receipt-body">
            <p><strong>Transaction ID:</strong> @Model.TransactionId</p>
            <p><strong>Transaction Time:</strong> @Model.TransactionTime.ToString("yyyy-MM-dd HH:mm:ss")</p>
            <p><strong>Payment Method:</strong>
                @switch(Model.PaymentMethod)
                {
                    case "CreditCard":
                        <span>Credit/Debit Card</span>
                        break;
                    case "CampusCard":
                        <span>Campus Card</span>
                        break;
                    case "MobileWallet":
                        <span>Mobile Wallet</span>
                        break;
                    default:
                        <span>@Model.PaymentMethod</span>
                        break;
                }
            </p>
            <p><strong>Payment Amount:</strong> $@Model.Amount.ToString("F2")</p>
            <hr>
            <p class="text-center">Thank you for your patronage!</p>
            <p class="text-center">Customer Service: 400-123-4567</p>
        </div>
    </div>
</div>

<style>
:root {
    --primary-green: #4CAF50;
    --light-green: #8BC34A;
    --background-gray: #F9F9F9;
    --text-primary: #333333;
    --text-secondary: #777777;
    --hover-green: #C8E6C9;
}

body {
    background-color: var(--background-gray);
    color: var(--text-primary);
}

.order-number {
    font-family: 'Courier New', monospace;
    background-color: #f8f9fa;
    padding: 0.3rem 0.6rem;
    border-radius: 4px;
    font-weight: bold;
    color: var(--primary-green);
    border: 1px solid #dee2e6;
}

.success-icon {
    animation: bounceIn 1s ease-in-out;
}

@@keyframes bounceIn {
    0% {
        transform: scale(0.3);
        opacity: 0;
    }
    50% {
        transform: scale(1.05);
    }
    70% {
        transform: scale(0.9);
    }
    100% {
        transform: scale(1);
        opacity: 1;
    }
}

.transaction-details {
    background-color: white;
    border-radius: 10px;
    padding: 20px;
    margin: 20px 0;
    border: 1px solid #e9ecef;
}

.detail-item {
    display: flex;
    align-items: center;
    margin-bottom: 15px;
}

.detail-item i {
    font-size: 1.5rem;
    margin-right: 15px;
    width: 30px;
    text-align: center;
    color: var(--primary-green);
}

.detail-content {
    flex: 1;
}

.detail-content strong {
    display: block;
    color: var(--text-primary);
    font-size: 0.9rem;
}

.detail-content p {
    margin: 5px 0 0 0;
    font-size: 1.1rem;
    color: var(--text-secondary);
}

.amount {
    font-size: 1.3rem !important;
    font-weight: bold !important;
    color: var(--primary-green) !important;
}

.processing-status {
    animation: fadeIn 2s ease-in-out;
}

@@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

.action-buttons .btn {
    border-radius: 8px;
    font-weight: 500;
    padding: 10px 15px;
}

.btn-success {
    background-color: var(--primary-green);
    border-color: var(--primary-green);
    color: white;
}

.btn-success:hover {
    background-color: var(--hover-green);
    border-color: var(--light-green);
    color: var(--text-primary);
}

.btn-outline-primary {
    border-color: var(--primary-green);
    color: var(--primary-green);
}

.btn-outline-primary:hover {
    background-color: var(--primary-green);
    border-color: var(--primary-green);
    color: white;
}

.btn-outline-info {
    border-color: var(--light-green);
    color: var(--light-green);
}

.btn-outline-info:hover {
    background-color: var(--light-green);
    border-color: var(--light-green);
    color: white;
}

.customer-service {
    border-top: 1px solid #e9ecef;
    padding-top: 20px;
}

.card {
    background-color: white;
    border: none;
}

.text-success {
    color: var(--primary-green) !important;
}

.text-muted {
    color: var(--text-secondary) !important;
}

.alert-info {
    background-color: var(--hover-green);
    border-color: var(--light-green);
    color: var(--text-primary);
}

.receipt {
    font-family: 'Courier New', monospace;
    width: 300px;
    margin: 0 auto;
    padding: 20px;
    border: 1px solid #000;
}

.receipt-header {
    text-align: center;
    margin-bottom: 20px;
}

.receipt-header h3 {
    margin: 0;
    font-size: 18px;
}

.receipt-body p {
    margin: 5px 0;
    font-size: 12px;
}

@@media print {
    body * {
        visibility: hidden;
    }
    
    #receiptContent, #receiptContent * {
        visibility: visible;
    }
    
    #receiptContent {
        position: absolute;
        left: 0;
        top: 0;
        display: block !important;
    }
}
</style>

<script>
function printReceipt() {
    window.print();
}

// Animation effects after page load
$(document).ready(function() {
    // Delayed display of processing status
    setTimeout(function() {
        $('.processing-status').fadeIn('slow');
    }, 1000);
    
    // Delayed display of action buttons
    setTimeout(function() {
        $('.action-buttons').fadeIn('slow');
    }, 1500);
});
</script>